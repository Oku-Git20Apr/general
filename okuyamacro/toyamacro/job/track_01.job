#!/bin/csh


  set period = 2017_04

  set user_name = `whoami`
  set base_dir  = `pwd`/../../../
  set incevt    = 500000

  foreach run (10226 10227 \
               10228 \
               10229 \
               10230 \
               10232 \
               10233 \
               10234 \
               10236 \
               10237 \
               10238 \
               10239 \
               10240 \
               10241 \
               10242 \
               10243 \
              10245 10246  10247 \
               10248 \
               10249 \
               10250 \
               10251 \
               10252 \
               10253 \
               10254 \
               10255 \
               10256 \
               10257 \
               10258 \
               10259 \
               10260 \
               10261 \
               10262 )
 # foreach run ( `cut -c-95 ${base_dir}/data/run_summary_${period}.txt | grep -i normal | tr 'n' ' ' | awk '{print $2}'` )

    set bgnevt = 1
    @ endevt = ${bgnevt} + ${incevt}
    @ endevt = ${endevt} - 1

    set root_dir = ${base_dir}job/root/track/${run}

    set nevent = `cut -c-95 ${base_dir}data/run_summary_${period}.txt |grep run${run} | awk '{print $3}'`
    while ( ${bgnevt} < ${nevent} )

echo ${run} ${bgnevt} ${nevent} ${nevent}
      if ( ${bgnevt} < 10 ) then
        set seven_digit_bgnevt = _000000${bgnevt}
      else if ( ${bgnevt} < 100 ) then
        set seven_digit_bgnevt = _00000${bgnevt}
      else if ( ${bgnevt} < 1000 ) then
        set seven_digit_bgnevt = _0000${bgnevt}
      else if ( ${bgnevt} < 10000 ) then
        set seven_digit_bgnevt = _000${bgnevt}
      else if ( ${bgnevt} < 100000 ) then
        set seven_digit_bgnevt = _00${bgnevt}
      else if ( ${bgnevt} < 1000000 ) then
        set seven_digit_bgnevt = _0${bgnevt}
      else
        set seven_digit_bgnevt = _${bgnevt}
      endif

      if ( ${endevt} < 10 ) then
        set seven_digit_endevt = _000000${endevt}
      else if ( ${endevt} < 100 ) then
        set seven_digit_endevt = _00000${endevt}
      else if ( ${endevt} < 1000 ) then
        set seven_digit_endevt = _0000${endevt}
      else if ( ${endevt} < 10000 ) then
        set seven_digit_endevt = _000${endevt}
      else if ( ${endevt} < 100000 ) then
        set seven_digit_endevt = _00${endevt}
      else if ( ${endevt} < 1000000 ) then
        set seven_digit_endevt = _0${endevt}
      else
        set seven_digit_endevt = _${endevt}
      endif

      set output_file = ${root_dir}/Track_${period}_${run}${seven_digit_bgnevt}${seven_digit_endevt}.root

      if (-e ${output_file} ) then
       echo ${output_file} exist.
      else
        echo No ${output_file}.

cat << EOF >!  .tracking_01.input
Universe     = vanilla
Initialdir   = ${base_dir}macros/toyamacro/job
Executable   = ${base_dir}macros/toyamacro/csh/track_01.csh
Arguments    = ${period} ${run} ${bgnevt} ${endevt}
+MachineList0 = Machine == "farm15.npex.prv"
+MachineList1 = Machine == "farm17.npex.prv"
+MachineList2 = Machine == "farm11.npex.prv"
+MachineList3 = Machine == "farm39.npex.prv"
+MachineList4 = Machine == "farm18.npex.prv"
+MachineList  = MachineList0 || MachineList1 || MachineList2 || MachineList3 || MachineList4
Requirements = MachineList && ( Arch == "X86_64" ) && (OpSys == "LINUX") && ( Memory > 500 )
getenv       = True
notification = Error
notify_user  = ${user_name}@lambda.phys.tohoku.ac.jp
Queue
EOF


        condor_submit .tracking_01.input


      endif
 
      @ bgnevt = ${bgnevt} + ${incevt}
      @ endevt = ${endevt} + ${incevt}

    end


 end
